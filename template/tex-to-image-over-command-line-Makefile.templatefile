texs = $(wildcard *.tex)

EXT  = .log .dvi .aux .pdf .out .glo .ist .png

.SUFFIXES:            # Delete the default suffixes
.SUFFIXES: tex $(EXT) # Define our suffix list

# -------------------------------------------------------------------------- #
# shell macro
# -------------------------------------------------------------------------- #
targets=\
	for d in $(texs); \
	do \
		echo $${d%.tex}.png; \
	done
##############################################################################

%.png: %.pdf
	convert -density 300 $< -quality 90 $(<:.pdf=.png)

%.pdf: %.tex
	latex  $<
	pdflatex "\def\formula{E=\frac{m_1v^2}{2}}\input{$(<)}"

# -------------------------------------------------------------------------- #
# -------------------------------------------------------------------------- #
# -------------------------------------------------------------------------- #

all: $(shell $(targets))
#
# ============================================================================
#

show:
	@evince *.pdf &

#
# ============================================================================
#

clean:
	-rm -rf $(addprefix *, $(EXT))
# END OF FILE
